###############################################################################
#
#	SMakefile
#
#	Makefile for the `SMake' utility required to build `AmiTCP Prefs'
#
#	1996 by Michael Neuweiler
#
###############################################################################

.c.o:
	sc $(CFLAGS) $(GST) $(OPTIONS) NOEXTDEF $*.c

.asm.o:
	ASM -D $*.asm

CPU		= ANY
#CPU		= 68030

#OPTIMIZE	= OPT OPTTIME NOOPTINLOCAL

OPTIONS	= CPU=$(CPU) $(OPTIMIZE)

GST		= GSTIMM GST=includes.gst

CFLAGS	= MCCONS ERRREXX STRMERGE NOSTKCHK IDLEN=65 NOVER IGN=105 NOMINC CNEST STREQ DEF=_M$(CPU) NOICONS
#CFLAGS	= MCCONS ERRREXX STRMERGE NOSTKCHK IDLEN=65 NOVER IGN=105 NOMINC CNEST STREQ DEF=_M$(CPU) NOICONS DBG=FULL

LFLAGS	= ND SC SD NOICONS MAXHUNK 100000
#LFLAGS	= SC SD NOICONS MAXHUNK 100000

OBJS		= globals.o main.o mui1.o mui2.o amiga.o
LIBS		= lib:amiga.lib lib:sc.lib

all:	 includes.gst AmiTCPPrefsStrings.h logo.bh AmiTCPPrefs

includes.gst:	includes.h
		GST >NIL: UNLOAD $@
		SC NOOBJNAME IDLEN=65 NOVERSION MAKEGST=$@ includes.h
		GST $@

logo.bh: logo.iff
	brush2c logo.iff >logo.bh

AmiTCPPrefsStrings.h: AmiTCPPrefsStrings.cd
	cat2h AmiTCPPrefsStrings.cd AmiTCPPrefsStrings.h

AmiTCPPrefs:	$(OBJS)
   SLINK WITH T:AmiTCPPrefs.WITH <<!(T:AmiTCPPrefs.WITH)
		FROM	lib:start.o $(OBJS)
		TO		AmiTCPPrefs
		LIB	$(LIBS)
		MAP	AmiTCPPrefs.map H
		$(LFLAGS)
	<

globals.o:	globals.c	AmiTCPPrefs.h AmiTCPPrefsStrings.h
	sc $(CFLAGS) $(GST) $(OPTIONS) globals.c
main.o:		main.c		AmiTCPPrefs.h AmiTCPPrefsStrings.h globals.c
mui1.o:		mui1.c		AmiTCPPrefs.h AmiTCPPrefsStrings.h globals.c
mui2.o:		mui2.c		AmiTCPPrefs.h AmiTCPPrefsStrings.h globals.c
amiga.o:		amiga.c		AmiTCPPrefs.h AmiTCPPrefsStrings.h globals.c
