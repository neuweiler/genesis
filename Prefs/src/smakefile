###############################################################################
#
#	SMakefile
#
#	Makefile for the `SMake' utility required to build `AmiTCP Prefs'
#
#	1996 by Michael Neuweiler
#
###############################################################################

.c.o:
	sc $(CFLAGS) $(GST) $(OPTIONS) NOEXTDEF $*.c

.asm.o:
	ASM -D $*.asm

CPU		= ANY
#CPU		= 68030
DEMO		= DEF=DEMO
#BETA		= DEF=BETA
#DEBUG	= DBG=LINE
OPTIMIZE	= OPT OPTTIME NOOPTINLOCAL
#NETCOM	= DEF=NETCOM

OPTIONS	= CPU=$(CPU) $(OPTIMIZE)
GST		= GSTIMM GST=includes.gst

CFLAGS	= MCCONS ERRREXX STRMERGE NOSTKCHK IDLEN=65 NOVER IGN=105 IGN=147 NOMINC CNEST STREQ NOICONS DEF=_M$(CPU) $(DEMO) $(BETA) $(DEBUG) $(NETCOM)

LFLAGS	= ND SC SD NOICONS MAXHUNK 100000
#LFLAGS	= SC SD NOICONS MAXHUNK 100000

OBJS		= globals.o main.o Stackcall.o mui1.o mui2.o mui3.o amiga.o
LIBS		= lib:amiga.lib lib:sc.lib

all:	 includes.gst locale/Strings.h images/logo.bh images/information.bh images/provider.bh images/user.bh images/modem.bh images/groups.bh images/databases.bh images/paths.bh AmiTCPPrefs
#all:	 includes.gst locale/Strings.h locale/empty.ct locale:catalogs/deutsch/AmiTCPPrefs.catalog images/logo.bh AmiTCPPrefs

includes.gst:	includes.h
		GST >NIL: UNLOAD $@
		SC NOOBJNAME IDLEN=65 NOVERSION MAKEGST=$@ includes.h
		GST $@

images/logo.bh: images/logo.iff
	brush2c images/logo.iff >images/logo.bh
images/information.bh: images/information.iff
	brush2c images/information.iff >images/information.bh
images/provider.bh: images/provider.iff
	brush2c images/provider.iff >images/provider.bh
images/user.bh: images/user.iff
	brush2c images/user.iff >images/user.bh
images/modem.bh: images/modem.iff
	brush2c images/modem.iff >images/modem.bh
images/groups.bh: images/groups.iff
	brush2c images/groups.iff >images/groups.bh
images/databases.bh: images/databases.iff
	brush2c images/databases.iff >images/databases.bh
images/paths.bh: images/paths.iff
	brush2c images/paths.iff >images/paths.bh

locale/Strings.h: locale/Strings.cd
	cat2h locale/Strings.cd locale/Strings.h
#locale/empty.ct : locale/Strings.cd
#	sc:c/FlexCat locale/Strings.cd NEWCTFILE locale/empty.ct
#locale:catalogs/deutsch/AmiTCPPrefs.catalog : locale/deutsch.ct
#	sc:c/FlexCat locale/Strings.cd locale/deutsch.ct CATALOG locale:catalogs/deutsch/AmiTCPPrefs.catalog
#	c:avail >nil: flush

AmiTCPPrefs:	$(OBJS)
   SLINK WITH T:AmiTCPPrefs.WITH <<!(T:AmiTCPPrefs.WITH)
		FROM	lib:start.o $(OBJS)
		TO		AmiTCPPrefs
		LIB	$(LIBS)
		MAP	AmiTCPPrefs.map H
		$(LFLAGS)
	<

globals.o:	globals.c	mui.h rev.h AmiTCPPrefs.h locale/Strings.h images/logo.bh images/information.bh images/provider.bh images/user.bh images/modem.bh images/groups.bh images/databases.bh images/paths.bh
	sc $(CFLAGS) $(GST) $(OPTIONS) globals.c
main.o:		main.c		mui.h rev.h AmiTCPPrefs.h locale/Strings.h globals.c
mui1.o:		mui1.c		mui.h rev.h AmiTCPPrefs.h locale/Strings.h globals.c images/logo.bh images/information.bh images/provider.bh images/user.bh images/modem.bh images/groups.bh images/databases.bh images/paths.bh
mui2.o:		mui2.c		mui.h rev.h AmiTCPPrefs.h locale/Strings.h globals.c images/logo.bh images/information.bh images/provider.bh images/user.bh images/modem.bh images/groups.bh images/databases.bh images/paths.bh
mui3.o:		mui3.c		mui.h rev.h AmiTCPPrefs.h locale/Strings.h globals.c images/logo.bh images/information.bh images/provider.bh images/user.bh images/modem.bh images/groups.bh images/databases.bh images/paths.bh
amiga.o:		amiga.c		mui.h rev.h AmiTCPPrefs.h locale/Strings.h globals.c
